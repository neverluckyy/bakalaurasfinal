{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export function useAuth(){return useContext(AuthContext);}export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{checkAuth();},[]);const checkAuth=async()=>{try{const response=await axios.get('/api/auth/me',{withCredentials:true});setUser(response.data.user);}catch(error){setUser(null);}finally{setLoading(false);}};const login=async(email,password)=>{try{const response=await axios.post('/api/auth/login',{email,password},{withCredentials:true});setUser(response.data.user);return{success:true};}catch(error){var _error$response,_error$response$data;return{success:false,error:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Login failed'};}};const register=async(email,password,display_name,avatar_key)=>{try{const response=await axios.post('/api/auth/register',{email,password,display_name,avatar_key},{withCredentials:true});setUser(response.data.user);return{success:true};}catch(error){var _error$response2,_error$response2$data;return{success:false,error:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||'Registration failed'};}};const logout=async()=>{try{await axios.post('/api/auth/logout',{},{withCredentials:true});}catch(error){console.error('Logout error:',error);}finally{setUser(null);}};const updateUser=updatedUser=>{setUser(updatedUser);};const value={user,loading,login,register,logout,updateUser,checkAuth};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","user","setUser","loading","setLoading","checkAuth","response","get","withCredentials","data","error","login","email","password","post","success","_error$response","_error$response$data","register","display_name","avatar_key","_error$response2","_error$response2$data","logout","console","updateUser","updatedUser","value","Provider"],"sources":["C:/Users/yoga/Downloads/bakalauras-main/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst AuthContext = createContext();\n\nexport function useAuth() {\n  return useContext(AuthContext);\n}\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const response = await axios.get('/api/auth/me', { withCredentials: true });\n      setUser(response.data.user);\n    } catch (error) {\n      setUser(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const login = async (email, password) => {\n    try {\n      const response = await axios.post('/api/auth/login', \n        { email, password }, \n        { withCredentials: true }\n      );\n      setUser(response.data.user);\n      return { success: true };\n    } catch (error) {\n      return { \n        success: false, \n        error: error.response?.data?.error || 'Login failed' \n      };\n    }\n  };\n\n  const register = async (email, password, display_name, avatar_key) => {\n    try {\n      const response = await axios.post('/api/auth/register', \n        { email, password, display_name, avatar_key }, \n        { withCredentials: true }\n      );\n      setUser(response.data.user);\n      return { success: true };\n    } catch (error) {\n      return { \n        success: false, \n        error: error.response?.data?.error || 'Registration failed' \n      };\n    }\n  };\n\n  const logout = async () => {\n    try {\n      await axios.post('/api/auth/logout', {}, { withCredentials: true });\n    } catch (error) {\n      console.error('Logout error:', error);\n    } finally {\n      setUser(null);\n    }\n  };\n\n  const updateUser = (updatedUser) => {\n    setUser(updatedUser);\n  };\n\n  const value = {\n    user,\n    loading,\n    login,\n    register,\n    logout,\n    updateUser,\n    checkAuth\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}